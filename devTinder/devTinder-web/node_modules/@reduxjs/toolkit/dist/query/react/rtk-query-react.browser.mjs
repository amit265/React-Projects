import{buildCreateApi as ve,coreModule as ze}from"@reduxjs/toolkit/query";import"@reduxjs/toolkit";import{batch as Ae,useDispatch as Be,useSelector as he,useStore as Ue}from"react-redux";import{createSelector as Ee}from"reselect";function K(e){return e.replace(e[0],e[0].toUpperCase())}import{createAction as Ie,createSlice as qe,createSelector as Ke,createAsyncThunk as Ve,combineReducers as _e,createNextState as je,isAnyOf as We,isAllOf as $e,isAction as Ge,isPending as Ze,isRejected as Je,isFulfilled as Ye,isRejectedWithValue as Xe,isAsyncThunkAction as et,prepareAutoBatched as tt,SHOULD_AUTOBATCH as rt,isPlainObject as G,nanoid as nt}from"@reduxjs/toolkit";function Y(e){return e.type==="query"}function X(e){return e.type==="mutation"}function z(e,...i){return Object.assign(e,...i)}import{formatProdErrorMessage as fe}from"@reduxjs/toolkit";import{QueryStatus as le,skipToken as H}from"@reduxjs/toolkit/query";import{useCallback as C,useDebugValue as ne,useEffect as N,useLayoutEffect as Qe,useMemo as A,useRef as F,useState as ie}from"react";import{shallowEqual as J}from"react-redux";var ee=WeakMap?new WeakMap:void 0,te=({endpointName:e,queryArgs:i})=>{let R="",D=ee?.get(i);if(typeof D=="string")R=D;else{let m=JSON.stringify(i,(x,f)=>(f=typeof f=="bigint"?{$bigint:f.toString()}:f,f=G(f)?Object.keys(f).sort().reduce((B,h)=>(B[h]=f[h],B),{}):f,f));G(i)&&ee?.set(i,m),R=m}return`${e}(${R})`};var w=Symbol();import{useEffect as ae,useRef as ye,useMemo as pe}from"react";function Z(e,i,R,D){let m=pe(()=>({queryArgs:e,serialized:typeof e=="object"?i({queryArgs:e,endpointDefinition:R,endpointName:D}):e}),[e,i,R,D]),x=ye(m);return ae(()=>{x.current.serialized!==m.serialized&&(x.current=m)},[m]),x.current.serialized===m.serialized?x.current.queryArgs:e}import{useEffect as de,useRef as ce}from"react";import{shallowEqual as re}from"react-redux";function V(e){let i=ce(e);return de(()=>{re(i.current,e)||(i.current=e)},[e]),re(i.current,e)?i.current:e}var Te=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ge=Te(),Re=()=>typeof navigator<"u"&&navigator.product==="ReactNative",De=Re(),xe=()=>ge||De?Qe:N,me=xe(),Se=e=>e.isUninitialized?{...e,isUninitialized:!1,isFetching:!0,isLoading:e.data===void 0,status:le.pending}:e;function se({api:e,moduleOptions:{batch:i,hooks:{useDispatch:R,useSelector:D,useStore:m},unstable__sideEffectsInRender:x,createSelector:f},serializeQueryArgs:B,context:h}){let k=x?t=>t():N;return{buildQueryHooks:b,buildMutationHook:I,usePrefetch:W};function j(t,o,p){if(o?.endpointName&&t.isUninitialized){let{endpointName:a}=o,u=h.endpointDefinitions[a];p!==H&&B({queryArgs:o.originalArgs,endpointDefinition:u,endpointName:a})===B({queryArgs:p,endpointDefinition:u,endpointName:a})&&(o=void 0)}let T=t.isSuccess?t.data:o?.data;T===void 0&&(T=t.data);let s=T!==void 0,n=t.isLoading,r=(!o||o.isLoading||o.isUninitialized)&&!s&&n,d=t.isSuccess||s&&(n&&!o?.isError||t.isUninitialized);return{...t,data:T,currentData:t.data,isFetching:n,isLoading:r,isSuccess:d}}function W(t,o){let p=R(),T=V(o);return C((s,n)=>p(e.util.prefetch(t,s,{...T,...n})),[t,p,T])}function b(t){let o=(s,{refetchOnReconnect:n,refetchOnFocus:r,refetchOnMountOrArgChange:d,skip:a=!1,pollingInterval:u=0,skipPollingIfUnfocused:c=!1}={})=>{let{initiate:U}=e.endpoints[t],y=R(),l=F(void 0);if(!l.current){let E=y(e.internalActions.internal_getRTKQSubscriptions());l.current=E}let S=Z(a?H:s,te,h.endpointDefinitions[t],t),g=V({refetchOnReconnect:n,refetchOnFocus:r,pollingInterval:u,skipPollingIfUnfocused:c}),M=F(!1),Q=F(void 0),{queryCacheKey:O,requestId:P}=Q.current||{},L=!1;O&&P&&(L=l.current.isRequestSubscribed(O,P));let v=!L&&M.current;return k(()=>{M.current=L}),k(()=>{v&&(Q.current=void 0)},[v]),k(()=>{let E=Q.current;if(typeof process<"u",S===H){E?.unsubscribe(),Q.current=void 0;return}let $=Q.current?.subscriptionOptions;if(!E||E.arg!==S){E?.unsubscribe();let q=y(U(S,{subscriptionOptions:g,forceRefetch:d}));Q.current=q}else g!==$&&E.updateSubscriptionOptions(g)},[y,U,d,S,g,v]),N(()=>()=>{Q.current?.unsubscribe(),Q.current=void 0},[]),A(()=>({refetch:()=>{if(!Q.current)throw new Error(fe(38));return Q.current?.refetch()}}),[])},p=({refetchOnReconnect:s,refetchOnFocus:n,pollingInterval:r=0,skipPollingIfUnfocused:d=!1}={})=>{let{initiate:a}=e.endpoints[t],u=R(),[c,U]=ie(w),y=F(void 0),l=V({refetchOnReconnect:s,refetchOnFocus:n,pollingInterval:r,skipPollingIfUnfocused:d});k(()=>{let Q=y.current?.subscriptionOptions;l!==Q&&y.current?.updateSubscriptionOptions(l)},[l]);let S=F(l);k(()=>{S.current=l},[l]);let g=C(function(Q,O=!1){let P;return i(()=>{y.current?.unsubscribe(),y.current=P=u(a(Q,{subscriptionOptions:S.current,forceRefetch:!O})),U(Q)}),P},[u,a]),M=C(()=>{y.current?.queryCacheKey&&u(e.internalActions.removeQueryResult({queryCacheKey:y.current?.queryCacheKey}))},[u]);return N(()=>()=>{y?.current?.unsubscribe()},[]),N(()=>{c!==w&&!y.current&&g(c,!0)},[c,g]),A(()=>[g,c,{reset:M}],[g,c,M])},T=(s,{skip:n=!1,selectFromResult:r}={})=>{let{select:d}=e.endpoints[t],a=Z(n?H:s,B,h.endpointDefinitions[t],t),u=F(void 0),c=A(()=>f([d(a),(g,M)=>M,g=>a],j,{memoizeOptions:{resultEqualityCheck:J}}),[d,a]),U=A(()=>r?f([c],r,{devModeChecks:{identityFunctionCheck:"never"}}):c,[c,r]),y=D(g=>U(g,u.current),J),l=m(),S=c(l.getState(),u.current);return me(()=>{u.current=S},[S]),y};return{useQueryState:T,useQuerySubscription:o,useLazyQuerySubscription:p,useLazyQuery(s){let[n,r,{reset:d}]=p(s),a=T(r,{...s,skip:r===w}),u=A(()=>({lastArg:r}),[r]);return A(()=>[n,{...a,reset:d},u],[n,a,d,u])},useQuery(s,n){let r=o(s,n),d=T(s,{selectFromResult:s===H||n?.skip?void 0:Se,...n}),{data:a,status:u,isLoading:c,isSuccess:U,isError:y,error:l}=d;return ne({data:a,status:u,isLoading:c,isSuccess:U,isError:y,error:l}),A(()=>({...d,...r}),[d,r])}}}function I(t){return({selectFromResult:o,fixedCacheKey:p}={})=>{let{select:T,initiate:s}=e.endpoints[t],n=R(),[r,d]=ie();N(()=>()=>{r?.arg.fixedCacheKey||r?.reset()},[r]);let a=C(function($){let q=n(s($,{fixedCacheKey:p}));return d(q),q},[n,s,p]),{requestId:u}=r||{},c=A(()=>T({fixedCacheKey:p,requestId:r?.requestId}),[p,r,T]),U=A(()=>o?f([c],o):c,[o,c]),y=D(U,J),l=p==null?r?.arg.originalArgs:void 0,S=C(()=>{i(()=>{r&&d(void 0),p&&n(e.internalActions.removeMutationResult({requestId:u,fixedCacheKey:p}))})},[n,p,r,u]),{endpointName:g,data:M,status:Q,isLoading:O,isSuccess:P,isError:L,error:v}=y;ne({endpointName:g,data:M,status:Q,isLoading:O,isSuccess:P,isError:L,error:v});let E=A(()=>({...y,originalArgs:l,reset:S}),[y,l,S]);return A(()=>[a,E],[a,E])}}}var oe=Symbol(),ue=({batch:e=Ae,hooks:i={useDispatch:Be,useSelector:he,useStore:Ue},createSelector:R=Ee,unstable__sideEffectsInRender:D=!1,...m}={})=>({name:oe,init(x,{serializeQueryArgs:f},B){let h=x,{buildQueryHooks:k,buildMutationHook:j,usePrefetch:W}=se({api:x,moduleOptions:{batch:e,hooks:i,unstable__sideEffectsInRender:D,createSelector:R},serializeQueryArgs:f,context:B});return z(h,{usePrefetch:W}),z(B,{batch:e}),{injectEndpoint(b,I){if(Y(I)){let{useQuery:t,useLazyQuery:o,useLazyQuerySubscription:p,useQueryState:T,useQuerySubscription:s}=k(b);z(h.endpoints[b],{useQuery:t,useLazyQuery:o,useLazyQuerySubscription:p,useQueryState:T,useQuerySubscription:s}),x[`use${K(b)}Query`]=t,x[`useLazy${K(b)}Query`]=o}else if(X(I)){let t=j(b);z(h.endpoints[b],{useMutation:t}),x[`use${K(b)}Mutation`]=t}}}}});export*from"@reduxjs/toolkit/query";import{configureStore as be,formatProdErrorMessage as Me}from"@reduxjs/toolkit";import{useContext as ke}from"react";import{useEffect as Pe}from"react";import*as _ from"react";import{Provider as Oe,ReactReduxContext as Fe}from"react-redux";import{setupListeners as Ne}from"@reduxjs/toolkit/query";function Le(e){let i=e.context||Fe;if(ke(i))throw new Error(Me(35));let[D]=_.useState(()=>be({reducer:{[e.api.reducerPath]:e.api.reducer},middleware:m=>m().concat(e.api.middleware)}));return Pe(()=>e.setupListeners===!1?void 0:Ne(D.dispatch,e.setupListeners),[e.setupListeners,D.dispatch]),_.createElement(Oe,{store:D,context:i},e.children)}var qt=ve(ze(),ue());export{Le as ApiProvider,w as UNINITIALIZED_VALUE,qt as createApi,ue as reactHooksModule,oe as reactHooksModuleName};
//# sourceMappingURL=rtk-query-react.browser.mjs.map